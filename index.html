<!DOCTYPE html>
<html>
  <head>
    <title>Mathstermind</title>
    <link rel="stylesheet" type="text/css" href="Mathstermind.css">
  </head>
  <style>
     @font-face {
      font-family: 'ChunkFiveRegular';
  src: url('fonts/chunkfive/Chunkfive.otf') format('opentype'),
       url('fonts/chunkfive/Chunkfive.ttf') format('truetype'),
       url('fonts/chunkfive/Chunkfive.woff') format('woff');
        font-weight: normal;
        font-style: normal;
}


      html,
      body {
        margin-top: 0;
        padding: 0;
        width: 100%;
        height: 101%;
        font-family: Arial, Helvetica, sans-serif;
        background: linear-gradient(to bottom right, #edbfd0 0%, #edbab8 10%, #9f9bcf 40%, #72c0f8 60%, #afe0cd 80%, #dca3b8 100%);
}

      .mathster{
        color:rgb(26, 70, 200);
        display: inline-block;
        font-size: 40px;
      }

      .mind{
        color: #b62aba;
        display: inline-block; 
        font-size: 40px;
      }

      h1{
        display: inline-block;
      }

      .chat-container {
        display: flex;
        flex-direction: column;
        border: 1px solid black;
        height: 300px;
        width: 72%;
        padding-bottom: 20px;
        overflow-y: scroll;
        align-self: center;
        white-space: pre-wrap;
        align-items: center;
      }

      .chat-message {
        margin: 10px;
        padding: 10px;
        border-radius: 10px;
        background-color: #f1f1f1;
        max-width: 90%;
        animation-duration: 1.0s;
        animation-name: slideIn;

      }

      .user-message {
        align-self: flex-end;
        background-color: #0084ff;
        color: white;
        animation-duration: 1.0s;
        animation-name: slideIn;
      }

      .bot-message {
        align-self: flex-start;
        background-color: rgba(197, 201, 218, 0.767);
        animation-duration: 1.0s;
        animation-name: slideIn; 
      }

      .intro-message {
        text-align: center;
        margin: 10px;
        padding: 5px;
        padding-right: 23px;
        border-radius: 10px;
        background-color: rgba(197, 201, 218, 0.767);
        max-width: 73%;
        height: 55px;
        align-self: flex-start;
        color: #0d2a31;
        animation-duration: 1.0s;
        animation-name: slideIn; 
}


      @keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(50%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

      textarea {
        width: 72%;
        height: 80px;
        padding: 12px 20px;
        box-sizing: border-box;
        border: 2px solid #ccc;
        border-radius: 4px;
        background-color: #f8f8f8;
        font-size: 16px;
        resize: none;
      }

      button {
        background-color: #0084ff;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      #user-guide-button{
        background-color: #1b77ce;
        width: 8%;
        height: 9%;
        align-self: center;
        padding:5px;
        position: absolute;
        top: 20px;
        right: 20px;
        background-color: rgb(46, 67, 99);
       color: rgb(255, 255, 255);
       padding: 10px 20px;
       border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }

      button.delete-btn {
        background-color: #de2417;
      }

      #feedback-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: rgb(46, 67, 99);
       color: rgb(255, 255, 255);
       padding: 10px 20px;
       border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 17px;
      }

      #note{
        margin-top: 0;
       color: #0d2a31;
       max-width: 74%;
       font-family: 'ChunkFiveRegular', sans-serif;
       font-weight: normal;
      }

      /* Small screens (mobile) */
@media only screen and (max-width: 600px) {
  body {
    padding-left: 17px;
  }

  h1 {
    font-size: 18px;
  }

  .chat-container {
    width: 100%;
  }

  textarea {
    width: 100%;
  }

user-guide-button{
        background-color: #1b77ce;
        width: 8%;
        height: 6%;
        align-self: center;
        padding:5px;
        position: absolute;
        top: 20px;
        right: 20px;
        background-color: rgb(46, 67, 99);
       color: rgb(255, 255, 255);
       padding: 10px 20px;
       border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 10px;
      }
    }

/* Medium screens (tablets) */
@media only screen and (min-width: 601px) and (max-width: 960px) {
  body {
    padding-left: 200px;
  }

  h1 {
    font-size: 36px;
  }

  .chat-container {
    width: 60%;
  }

  textarea {
    width: 60%;
  }
}

/* Large screens (desktops) */
@media only screen and (min-width: 961px) {
  body {
    padding-left: 220px;
  }

  h1 {
    font-size: 48px;
  }

  .chat-container {
    width: 72%;
  }

  textarea {
    width: 72%;
  }
}
  </style>
  <body>
    <h1><span class="mathster">Mathster</span><span class="mind">mind</span></h1><img src="beta.png"  style="width: 125px; height: 28px; padding-left: 15px;"><img>

    <button id="user-guide-button" onclick="  window.location.href='User_guide.html'">User Guide</button>
    <p id="note">Note: This is only the beta version. More functionality will be added soon. If you are having any issues, feel free to click the feedback button and let me know what to improve.</p>
    <div class="chat-container">
     <div class="intro-message"> 
      Hello! How can I assist you today?
     </div>
    </div>
    <form>
      <br>
      <textarea id="user-input" placeholder="Enter a mathematical expression here."></textarea>
      <br />
      <button type="submit">Send</button>
      <button type="button" class="delete-btn">Delete</button>
      <button onclick="sendFeedback(event)" id="feedback-button">Feedback</button>
      <script>
      function sendFeedback(event) {
          event.preventDefault(); // prevents message from being sent to chat container
          window.location.href='https://docs.google.com/forms/d/e/1FAIpQLSffaakUz5JCB1ulpu2LoZVgInZ5YG1bNcOAt6-Dxm6gLsWnQg/viewform?usp=sf_link';
  }
      </script>
    </form>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.js"></script>
    <script>
      window.scrollTo(0, document.body.scrollHeight);
const form = document.querySelector("form");
const userInput = document.querySelector("#user-input");
const chatContainer = document.querySelector(".chat-container");
const deleteBtn = document.querySelector(".delete-btn");
let botMessageText = "Hello! How can I assist you today?";

// send message function
function sendMessage() {
  const userMessage = document.createElement("div");
  userMessage.textContent = userInput.value;
  userMessage.className = "chat-message user-message";
  chatContainer.appendChild(userMessage);

  // clear the user input field
  userInput.value = "";

  // use math.js to evaluate the user's input
  let input = userMessage.textContent;
  let result;
  try {
    result = math.evaluate(input);
  } catch (error) {
    result =
      "Sorry, I could not understand your question. Can you please rephrase it?";
  }

  setTimeout(() => {
    const botMessage = document.createElement("div");
    botMessage.textContent = result;
    botMessage.className = "chat-message bot-message";
    chatContainer.appendChild(botMessage);

    // scroll to the latest message
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }, 0900); // 1-second delay

}

function deleteChatHistory() {
  // remove all chat messages
  while (chatContainer.firstChild) {
    chatContainer.removeChild(chatContainer.firstChild);
  }

  // add a new bot message to prompt the user for input
  const newBotMessage = document.createElement("div");
  newBotMessage.textContent = botMessageText;
  newBotMessage.className = "chat-message bot-message";
  chatContainer.appendChild(newBotMessage);

  // scroll to the latest message
  chatContainer.scrollTop = chatContainer.scrollHeight;
}

// send message on form submit or enter key press
form.addEventListener("submit", (e) => {
  e.preventDefault();
  sendMessage(),toLowerCase;
});

userInput.addEventListener("keydown", (e) => {
  if (e.keyCode === 13 && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  } else if (e.keyCode === 13 && e.shiftKey) {
    e.preventDefault();
    let startPos = userInput.selectionStart;
    let endPos = userInput.selectionEnd;
    userInput.value =
      userInput.value.substring(0, startPos) +
      "\n" +
      userInput.value.substring(endPos, userInput.value.length);
    userInput.setSelectionRange(startPos + 1, startPos + 1);
  } else if (e.keyCode === 46 && chatContainer.childNodes.length > 1) {
    deleteChatHistory();
  }
});

// add event listener to delete button
deleteBtn.addEventListener("click", () => {
  deleteChatHistory();
});

// add event listener to window unload to save the bot message text to local storage
window.addEventListener("unload", () => {
  localStorage.setItem("botMessageText", botMessageText);
});

// retrieve the bot message text from local storage if it exists
if (localStorage.getItem("botMessageText")) {
  botMessageText = localStorage.getItem("botMessageText");
}
    </script>
  </body>
</html>
